<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/profdefault}">
<head>
    <link rel="stylesheet" href="/css/prof/assignment.css">
    <link rel="stylesheet" href="https://uicdn.toast.com/tui.pagination/latest/tui-pagination.css" />
    <link rel="stylesheet" href="https://uicdn.toast.com/grid/latest/tui-grid.css" />
    <script type="text/javascript" src="https://uicdn.toast.com/tui.pagination/v3.4.0/tui-pagination.js"></script>
    <script>
        $(document).ready(function() {
            $('#searchForm').submit(function(event) {
                event.preventDefault();
                var lectId = $('#lectId').val();
                var assiId = $('#assiId').val();

                // Make an AJAX request to fetch student data based on lectId and assiId
                $.ajax({
                    type: 'GET',
                    url: '/prof/findStudentInfo',
                    data: { lectId: lectId, assiId: assiId },
                    success: function(data) {
                        // Update the table with student data
                        var studentTable = $('#studentTable');
                        studentTable.empty();
                        $.each(data, function(index, student) {
                            studentTable.append('<tr>' +
                                '<td>' + student.member.memberId + '</td>' +
                                '<td>' + student.member.userName + '</td>' +
                                '<td>' + student.studGrade + '</td>' +
                                '<td>' + student.studMaxCr + '</td>' +
                                '<td>' + student.studNowCr + '</td>' +
                                '<td>' + student.studCreCpl + '</td>' +
                                '</tr>');
                        });
                    },
                    error: function() {
                        alert('An error occurred while fetching student data.');
                    }
                });
            });
        });
    </script>
</head>

<div id="mainFrame" layout:fragment="content" class="mainFrame">

    <div class="assi_body">
        <form id="searchForm">
        <div class="assi_back_btn_box">
            <div class="assi_course_search_text_box">
                <span>ğŸ”&nbsp ê³¼ì œê²€ìƒ‰</span>
            </div>
<!--            <div class="assi_back_btn">-->
<!--                <button type="button" class="backBtn">ëŒì•„ê°€ê¸°</button>-->
<!--            </div>-->
        </div>
        <div class="assi_search_box">
            <div class="assi_search_bottom_box">
                <div class="assi_ch_lect_name">
                    <div class="assi_search_lect_name_text">
                        <span>ê°•ì¢Œëª…</span>
                    </div>
                    <div class="assi_search_lect_name">
                        <input id="lectId" style="width: 351px; height: 35px; border-radius: 5px; border: 1px solid #cccccc; outline: none; text-indent: 5px;" type="text" th:value="${lectInfo.lectName}" readonly/>
                    </div>
                </div>
            </div>
            <div class="assi_search_bottom_box">
                <div class="assi_ch_lect_name">
                    <div class="assi_search_lect_name_text">
                        <span>ê³¼ì œëª…</span>
                    </div>
                    <div class="assi_search_lect_name">
                        <select id="assiId" style="width: 351px; height: 35px; border-radius: 5px; border: 1px solid #cccccc; outline: none; text-indent: 5px;">
                            <option th:each="assignment : ${assignmentsList}"
                                    th:value="${assignment.getAssiId}"
                                    th:text="${assignment.name}">
                            </option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
            <button type="submit">ì œì¶œ</button>
        </form>

            <div class="assi_total_status_text_box">
                <span>ğŸ“Š&nbsp ê³¼ì œì •ë³´</span>
                <div class="assi_que_btn_box">
                    <button type="button" class="assi_que_btn"><a th:href="@{'/prof/lecture/view/' + ${lectId} + '/assignments/add'}">ê³¼ì œì¶œì œ</a></button>
                </div>
            </div>
            <div class="assi_ch_total_status_grid1">
                <table class="assi_ch_assi_info_tb">
                    <thead>
                        <tr>
                            <td><span>ê³¼ì œë²ˆí˜¸</span></td>
                            <td><span>ê³¼ì œëª…</span></td>
                            <td><span>ì œì¶œì‹œì‘ì¼ì‹œ</span></td>
                            <td><span>ì œì¶œë§ˆê°ì¼ì‹œ</span></td>
                            <td><span>ì§„í–‰ìƒíƒœ</span></td>
                            <td><span>ê³¼ì œìˆ˜ì •</span></td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:each="assignment : ${assignmentsList}">
                            <td><span th:text="${assignment.getAssiId}"></span></td>
                            <td><span th:text="${assignment.name}"></span></td>
                            <td><span th:text="${assignment.start}"></span></td>
                            <td><span th:text="${assignment.end}"></span></td>
                            <td><span th:text="${assignment.isActive ? 'ì§„í–‰ì¤‘' : 'ë§ˆê°'}"></span></td>
                            <td>
                                <a type="button" class="assiDeleteBtn" th:href="@{'/prof/lecture/view/' + ${lectId} + '/assignments/'+ ${assignment.getAssiId}+ '/submit'}"><span>ì œì¶œ</span></a>
                                <a type="button" class="assiUpdateBtn" th:href="@{'/prof/lecture/view/' + ${lectId} + '/assignments/'+ ${assignment.getAssiId}+ '/modify'}"><span>ìˆ˜ì •</span></a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="assi_stu_info_text_box">
                <span>ğŸ™Œ&nbsp í•™ìƒì •ë³´</span>
            </div>
            <div class="assi_ch_total_status_grid2">
                <table id="studentTable" class="assi_ch_stud_info_tb">
                    <thead>
                        <tr>
                            <td><span>í•™ë²ˆ</span></td>
                            <td><span>ì„±ëª…</span></td>
                            <td><span>ì œì¶œì¼ì‹œ</span></td>
                            <td><span>ì œì¶œêµ¬ë¶„</span></td>
                            <td><span>ê³¼ì œì œì¶œì •ë³´</span></td>
                            <td><span>í”¼ë“œë°±</span></td>
                        </tr>
                    </thead>
                    <tbody>

                    </tbody>
                </table>
            </div>
    </div>
    <script src="/js/prof/assignment.js"></script>
</div>